<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body { margin: 0; overflow: hidden; background: #000; touch-action: none; font-family: sans-serif; }
    #game-container { position: relative; width: 100vw; height: 55vh; background: #87CEEB; overflow: hidden; border-bottom: 4px solid #fff; }
    #game-world { position: absolute; width: 10500px; height: 100%; left: 0; top: 0; transition: none; }
    #static-ground { position: absolute; bottom: 0; width: 10500px; height: 40px; background: #8b4513; border-top: 4px solid #5d2e0d; z-index: 1; }
    #player { position: absolute; width: 40px; height: auto; z-index: 10; bottom: 40px; left: 50px; }
    .fish-weapon { position: absolute; font-size: 25px; z-index: 5; }
    .enemy { position: absolute; width: 40px; height: 40px; text-align: center; font-size: 28px; line-height: 40px; z-index: 8; bottom: 40px; }
    .obj { position: absolute; background: #cd853f; border: 2px solid #8b4513; box-sizing: border-box; z-index: 7; }
    .item-block { background: #4169e1; border: 2px solid #fff; border-radius: 4px; box-shadow: 0 0 10px #4169e1; }
    #info-panel { position: absolute; top: 10px; right: 20px; text-align: right; color: #fff; font-weight: bold; font-size: 13px; z-index: 100; text-shadow: 2px 2px #000; }
    .pole { position: absolute; bottom: 40px; width: 8px; height: 150px; background: #ddd; border: 1px solid #999; z-index: 6; }
    .flag { position: absolute; width: 50px; height: 35px; left: 8px; top: 0; }
    #start-flag { background: #0a0; }
    #goal-flag { background: #fff; border: 1px solid #ccc; }
    #goal-flag::after { content: ""; position: absolute; top: 7px; left: 15px; width: 20px; height: 20px; background: red; border-radius: 50%; }
    #ui-panel { width: 100vw; height: 45vh; background: #222; display: flex; align-items: center; justify-content: center; position: relative; z-index: 1000; }
    .btn-group { display: flex; gap: 15px; }
    .btn { width: 75px; height: 75px; background: #444; border: 3px solid #777; border-radius: 50%; color: #fff; font-weight: bold; text-align: center; line-height: 75px; user-select: none; -webkit-tap-highlight-color: transparent; }
  </style>
</head>
<body onclick="bootGame()">
  <div id="game-container">
    <div id="info-panel"><div id="score-board">SCORE: 0 / 1000</div></div>
    <div id="game-world">
      <div id="static-ground"></div>
      <div id="entities"></div>
      <div class="pole" style="left: 30px;"><div class="flag" id="start-flag"></div></div>
      <img src="https://yuu073148.github.io/creator-game/character.png" id="player">
      <div class="pole" style="left: 9800px; height: 300px;"><div class="flag" id="goal-flag"></div></div>
    </div>
  </div>
  <div id="ui-panel">
    <div class="btn-group">
      <div class="btn" id="btn-left">‚Üê</div><div class="btn" id="btn-right">‚Üí</div>
      <div class="btn" id="btn-fire" style="background:#058; border-color:#0cf;">FISH</div>
      <div class="btn" id="btn-jump" style="background:#228; border-color:#55f;">JUMP</div>
    </div>
  </div>

<script>
  const YT_URL = "https://www.youtube.com/@S_even7";
  const player = document.getElementById('player'), world = document.getElementById('game-world'), entities = document.getElementById('entities'), scoreEl = document.getElementById('score-board');
  let ctx, px = 50, py = 40, vx = 0, vy = 0, score = 0, jumpCount = 0, isGoal = false, isDead = false, active = false;
  const gravity = 0.8, keys = { left: false, right: false };

  function bootGame() {
    if (active) return; active = true;
    if (!ctx) ctx = new (window.AudioContext || window.webkitAudioContext)();
    if (ctx.state === 'suspended') ctx.resume();
    initWorld();
    setupControls();
    setInterval(gameLoop, 30);
    // BGMÂÜçÁîü
    const notes = [262, 330, 392, 523]; let i = 0;
    setInterval(() => { if(!isDead && !isGoal) playSound(notes[i++%4], 'square', 0.1); }, 400);
  }

  function initWorld() {
    entities.innerHTML = '';
    // Èùí„Éñ„É≠„ÉÉ„ÇØÂÜçÈÖçÁΩÆ
    [600, 1500, 3000, 5000, 7500].forEach(x => {
      const b = document.createElement('div'); b.className = 'obj item-block'; b.style.left = x+'px'; b.style.bottom = '120px'; b.style.width = '40px'; b.style.height = '40px'; entities.appendChild(b);
    });
    // ÊïµÈÖçÁΩÆ
    for(let i=0; i<25; i++) {
      const e = document.createElement('div'); e.className = 'enemy'; e.style.left = (1200 + i*400 + Math.random()*200)+'px';
      e.innerHTML = ['üê§','üê¢','üê¨'][i%3]; entities.appendChild(e);
    }
  }

  function playSound(f, t, d) {
    if(!ctx) return; const o = ctx.createOscillator(), g = ctx.createGain();
    o.type = t; o.frequency.setValueAtTime(f, ctx.currentTime); o.connect(g); g.connect(ctx.destination);
    o.start(); g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + d); o.stop(ctx.currentTime + d);
  }

  function setupControls() {
    const bind = (id, k) => {
      const b = document.getElementById(id);
      b.onmousedown = b.ontouchstart = (e) => { e.preventDefault(); if(k) keys[k] = true; };
      b.onmouseup = b.ontouchend = (e) => { e.preventDefault(); if(k) keys[k] = false; };
    };
    bind('btn-left', 'left'); bind('btn-right', 'right');
    document.getElementById('btn-jump').ontouchstart = (e) => { e.preventDefault(); if(!isDead && jumpCount < 1) { vy = 16; jumpCount++; playSound(400, 'triangle', 0.2); } };
    document.getElementById('btn-fire').ontouchstart = (e) => { e.preventDefault(); fire(); };
  }

  function fire() {
    if(isDead) return; playSound(800, 'sine', 0.1);
    const f = document.createElement('div'); f.className = 'fish-weapon'; f.innerHTML = 'üêü';
    f.style.left = (px + 40) + 'px'; f.style.bottom = (py + 10) + 'px'; world.appendChild(f);
    let fx = px + 40;
    const ft = setInterval(() => {
      fx += 15; f.style.left = fx + 'px';
      document.querySelectorAll('.enemy').forEach(en => {
        let ex = parseInt(en.style.left);
        if (Math.abs(fx - ex) < 30) { en.remove(); f.remove(); addScore(100); clearInterval(ft); }
      });
      if (fx > px + 600) { f.remove(); clearInterval(ft); }
    }, 20);
  }

  function addScore(v) {
    score = Math.min(1000, score + v);
    scoreEl.innerText = `SCORE: ${score} / 1000`;
    playSound(1200, 'sine', 0.1);
  }

  function gameLoop() {
    if(isGoal || isDead) return;
    vx = (keys.right - keys.left) * 8;
    if(vx !== 0) player.style.transform = vx > 0 ? "scaleX(1)" : "scaleX(-1)";
    px += vx; vy -= gravity; py += vy;
    if (py <= 40) { py = 40; vy = 0; jumpCount = 0; }
    player.style.left = px + 'px'; player.style.bottom = py + 'px';
    world.style.left = -(px - 50) + 'px';

    document.querySelectorAll('.enemy').forEach(en => {
      let ex = parseInt(en.style.left);
      let dx = Math.abs(px - ex);
      let dy = Math.abs(py - 40);
      if (dx < 30 && dy < 30) {
        if (vy < 0 && py > 50) { en.remove(); vy = 13; addScore(100); }
        else { isDead = true; alert("GAME OVER"); location.reload(); }
      }
    });

    if(px > 9780 || score >= 1000) {
      isGoal = true; alert("MISSION COMPLETE! „ÉÅ„É£„É≥„Éç„É´ÁôªÈå≤„Çà„Çç„Åó„Åè„Å™ÔºÅ");
      window.open(YT_URL, '_blank'); location.reload();
    }
  }
</script>
</body>
</html>
